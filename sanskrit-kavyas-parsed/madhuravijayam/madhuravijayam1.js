// Dictionary-style data embedded directly in JS
const shloka = [
  {
    "id": "1.1",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "कल्याणाय सताम्",
            "meaning": "For the welfare of the good,",
            "text": "कल्याणाय सतां"
          },
          {
            "parsed": "भूयात् देवः",
            "meaning": "may the God be,",
            "text": "भूयाद् देवो"
          },
          {
            "parsed": "दन्तावल-आननः",
            "meaning": "the elephant-faced one (Ganesha)",
            "text": "दन्तावलाननः",
            "samasa_vigraha": "दन्तावलस्य आननम् यस्य सः"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "शरणागत-सङ्कल्प-कल्पना-कल्प-पादपः",
            "meaning": "who is a wish-fulfilling tree for realizing the desires of those who seek refuge",
            "text": "शरणागतसङ्कल्पकल्पनाकल्पपादपः",
            "samasa_vigraha": "शरणागतानां सङ्कल्पस्य कल्पनायाः कल्पः पादपः सः"
          }
        ]
      }
    ]
  },
  {
    "id": "1.2",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "स्रष्टुः",
            "meaning": "of the creator",
            "text": "स्रष्टुः",
          },
          {
            "parsed": "स्त्री-पुंस-निर्माण-मातृका-रूप-धारिणौ",
            "meaning": "The two who bear the form of the matrix for the fashioning of male and female,",
            "text": "स्त्रीपुंसनिर्माणमातृकारूपधारिणौ",
            "samasa_vigraha": "स्त्रीपुंसयोः निर्माणे या मातृका तस्याः रूपं धारयतः"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "प्रपद्ये",
            "meaning": "I resort to",
            "text": "प्रपद्ये"
          },
          {
            "parsed": "प्रतिबोधाय",
            "meaning": "for awakening",
            "text": "प्रतिबोधाय"
          },
          {
            "parsed": "चित्-प्रकाश-आत्मकौ शिवौ",
            "meaning": "the two Shivas (Shiva and Shakti), whose nature is the light of consciousness",
            "text": "चित्प्रकाशात्मकौ शिवौ",
            "samasa_vigraha": "चित्प्रकाशः एव आत्मा ययोः तौ"
          }
        ]
      }
    ]
  },
  {
    "id": "1.3",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "महा-कवि-मुख-अम्भोज-मणि-पञ्जर-शारिकाम्",
            "meaning": "The talking bird in the jewel-cage of the lotus-mouths of great poets,",
            "text": "महाकविमुखाम्भोजमणिपञ्जरशारिकाम्",
            "samasa_vigraha": "महाकवीनां मुखानि अम्भोजानि इव, तेषां मणिपञ्जरे शारिकाम्"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "चैतन्य-जलधि-ज्योत्स्नाम्",
            "meaning": "the moonlight on the ocean of consciousness,",
            "text": "चैतन्यजलधिज्योत्स्नां",
            "samasa_vigraha": "चैतन्यम् एव जलधिः, तस्य ज्योत्स्ना"
          },
          {
            "parsed": "देवीं वन्दे सरस्वतीम्",
            "meaning": "I praise the Goddess Sarasvati",
            "text": "देवीं वन्दे सरस्वतीम्"
          }
        ]
      }
    ]
  },
  {
    "id": "1.4",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "असाधारण-सार्वज्ञ्यम्",
            "meaning": "Of extraordinary omniscience,",
            "text": "असाधारणसार्वज्ञ्यं",
            "samasa_vigraha": "नास्ति साधारणं यस्य तत् असाधारणं च तत् सार्वज्ञ्यं च"
          },
          {
            "parsed": "विलसत्-सर्व-मङ्गलम्",
            "meaning": "in whom all auspiciousness shines,",
            "text": "विलसत्सर्वमङ्गलम्",
            "samasa_vigraha": "विलसन्ति सर्वाणि मङ्गलानि यस्मिन् तम्"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "क्रिया-शक्ति-गुरुम्",
            "meaning": "the master of the power of action,",
            "text": "क्रियाशक्तिगुरुं",
            "samasa_vigraha": "क्रियाशक्तेः गुरुः तम्"
          },
          {
            "parsed": "वन्दे",
            "meaning": "I praise,",
            "text": "वन्दे"
          },
          {
            "parsed": "त्रिलोचनम् इव अपरम्",
            "meaning": "like another Three-Eyed one (Shiva)",
            "text": "त्रिलोचनमिवापरम्",
            "samasa_vigraha": "त्रीणि लोचनानि यस्य सः"
          }
        ]
      }
    ]
  },
  {
    "id": "1.5",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "चेतसः अस्तु प्रसादाय सताम्",
            "meaning": "May he be for the clarity of the minds of the virtuous,",
            "text": "चेतसोऽस्तु प्रसादाय सतां"
          },
          {
            "parsed": "प्राचेतसः मुनिः",
            "meaning": "the sage Prachetasa (Valmiki)",
            "text": "प्राचेतसो मुनिः"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "पृथिव्याम् पद्य-निर्माण-विद्यायाः",
            "meaning": "of the art of crafting verse on earth",
            "text": "पृथिव्यां पद्यनिर्माणविद्यायाः",
            "samasa_vigraha": "पद्यस्य निर्माणस्य विद्या पृथिव्याम्"
          },
          {
            "parsed": "प्रथमम् पदम्",
            "meaning": "the first abode (and originator)",
            "text": "प्रथमं पदम्"
          }
        ]
      }
    ]
  },
  {
    "id": "1.6",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "वैयासिके गिराम् गुम्फे",
            "meaning": "In the composition of Vyasa's words,",
            "text": "वैयासिके गिरां गुम्फे"
          },
          {
            "parsed": "पुण्ड्र-इक्षौ इव लभ्यते",
            "meaning": "is found, like in the Pundra sugarcane,",
            "text": "पुण्ड्रेक्षाविव लभ्यते",
            "samasa_vigraha": "पुण्ड्रः च असौ इक्षुः च तस्मिन्"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "सद्यः सहृदय-आह्लादी",
            "meaning": "immediately delighting the connoisseur's heart,",
            "text": "सद्यः सहृदयाह्लादी",
            "samasa_vigraha": "सद्यः सहृदयान् आह्लादयति यः"
          },
          {
            "parsed": "सारः",
            "meaning": "the essence",
            "text": "सारः"
          },
          {
            "parsed": "पर्वणि पर्वणि",
            "meaning": "in every section (or knot)",
            "text": "पर्वणि पर्वणि"
          }
        ]
      }
    ]
  },
  {
    "id": "1.7",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "दासतां कालिदासस्य",
            "meaning": "Servitude to Kalidasa,",
            "text": "दासतां कालिदासस्य"
          },
          {
            "parsed": "कवयः के न बिभ्रति",
            "meaning": "which poets do not bear?",
            "text": "कवयः के न बिभ्रति"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "इदानीम् अपि",
            "meaning": "Even now,",
            "text": "इदानीमपि"
          },
          {
            "parsed": "तस्य अर्थान् उपजीवन्ति अमी यतः",
            "meaning": "since these (poets) live upon his ideas",
            "text": "तस्यार्थानुपजीवन्त्यमी यतः"
          }
        ]
      }
    ]
  },
  {
    "id": "1.8",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "वाणी-पाणि-परामृष्ट-वीणा-निक्वाणहारिणीम्",
            "meaning": "Her (speech) which steals the sound of a veena touched by the hand of Sarasvatī,",
            "text": "वाणीपाणिपरामृष्टवीणानिक्वाणहारिणीम्",
            "samasa_vigraha": "वाण्याः पाणिना परामृष्टा या वीणा, तस्याः निक्वाणम् हरति या"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "भावयन्ति कथं वा अन्ये",
            "meaning": "how else can others appreciate",
            "text": "भावयन्ति कथं वान्ये"
          },
          {
            "parsed": "भट्टबाणस्य भारतीम्",
            "meaning": "the speech of Bhaṭṭa Bāṇa?",
            "text": "भट्टबाणस्य भारतीम्"
          }
        ]
      }
    ]
  },
  {
    "id": "1.9",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "विमर्द-व्यक्त-सौरभ्या",
            "meaning": "Whose fragrance becomes manifest upon critical examination,",
            "text": "विमर्दव्यञ्जत्सौरभ्या",
            "samasa_vigraha": "विमर्देन व्यक्तं सौरभ्यं यस्याः सा"
          },
          {
            "parsed": "भारती भारवेः कवेः",
            "meaning": "the speech of the poet Bhāravi;",
            "text": "भारती भारवेः कवेः"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "धत्ते",
            "meaning": "produces",
            "text": "धत्ते"
          },
          {
            "parsed": "वकुल-माला इव",
            "meaning": "like a garland of Bakula flowers",
            "text": "वकुलमालेव",
            "samasa_vigraha": "वकुलानां माला इव"
          },
          {
            "parsed": "विदग्धानां चमत्क्रियाम्",
            "meaning": "astonishment in the connoisseurs",
            "text": "विदग्धानां चमत्क्रियाम्"
          }
        ]
      }
    ]
  },
  {
    "id": "1.10",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "आचार्य-दण्डिनः वाचाम्",
            "meaning": "Of the words of Ācārya Dandi,",
            "text": "आचार्यदण्डिनो वाचाम्"
          },
          {
            "parsed": "आचान्त-अमृत-संपदाम्",
            "meaning": "which have tasted the richness of nectar,",
            "text": "आचान्तामृतसंपदाम्",
            "samasa_vigraha": "आचान्ता अमृतस्य संपत् यया सा"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "विकासः",
            "meaning": "the manifestation",
            "text": "विकासो"
          },
          {
            "parsed": "वेधसः पत्न्याः",
            "meaning": "of the wife of the Creator (Sarasvatī)",
            "text": "वेधसः पत्न्याः"
          },
          {
            "parsed": "विलास-मणि-दर्पणः",
            "meaning": "is a pleasure-jewel-mirror",
            "text": "विलासमणिदर्पणः",
            "samasa_vigraha": "विलासार्थः मणिदर्पणः"
          }
        ]
      }
    ]
  },
  {
    "id": "1.11",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "सा का अपि सुरभिः",
            "meaning": "She is some kind of fragrance,",
            "text": "सा कापि सुरभिः"
          },
          {
            "parsed": "शङ्के",
            "meaning": "I think",
            "text": "शङ्के"
          },
          {
            "parsed": "भवभूतेः सरस्वती",
            "meaning": "the Sarasvatī (speech) of Bhavabhūति,",
            "text": "भवभूतेः सरस्वती"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "कर्णेषु लब्ध-वर्णानां",
            "meaning": "for the ears of those who have received her words,",
            "text": "कर्णेषु लब्धवर्णानां"
          },
          {
            "parsed": "सूते",
            "meaning": "produces",
            "text": "सूते"
          },
          {
            "parsed": "सुख-मयीं सुधाम्",
            "meaning": "nectar composed of happiness",
            "text": "सुखमयीं सुधाम्"
          }
        ]
      }
    ]
  },
  {
    "id": "1.12",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "मन्दार-मञ्जरी-स्यन्दि-मकरन्द-रस-आब्धयः",
            "meaning": "Oceans of the essence of nectar dripping from Mandāra flower clusters,",
            "text": "मन्दारमञ्जरीस्यन्दिमकरन्दरसाब्धयः",
            "samasa_vigraha": "मन्दार-मञ्जरीभ्यः स्यन्दी, यः मकरन्दः, तस्य रसस्य अब्धयः"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "कस्य न आह्लादनाय अलम्",
            "meaning": "For whose delight are they not sufficient?",
            "text": "कस्य नाह्लादनायालं"
          },
          {
            "parsed": "कर्णामृतकवेः गिरः",
            "meaning": "the words of the poet karnaamrta?",
            "text": "कर्णामृतकवेर्गिरः"
          }
        ]
      }
    ]
  },
  {
    "id": "1.13",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "तिक्कयस्य कवेः सूक्तिः",
            "meaning": "The fine saying of the poet Tikkaya Yajvan,",
            "text": "तिक्कयस्य कवेः सूक्तिः"
          },
          {
            "parsed": "कौमुदी इव",
            "meaning": "like the moonlight",
            "text": "कौमुदीव"
          },
          {
            "parsed": "कलानिधेः",
            "meaning": "of the moon (treasure of arts);",
            "text": "कलानिधेः"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "सतृष्णैः कविभिः",
            "meaning": "by eager poets",
            "text": "सतृष्णैः कविभिः"
          },
          {
            "parsed": "स्वैरं",
            "meaning": "at will,",
            "text": "स्वैरं"
          },
          {
            "parsed": "चकोरैः इव सेव्यते",
            "meaning": "is savored, like (moonlight) by Chakora birds",
            "text": "चकोरैरिव सेव्यते"
          }
        ]
      }
    ]
  },
  {
    "id": "1.14",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "चतुस्सप्तति-काव्य-उक्ति-व्यक्त-वैदुष्य-सम्पदे",
            "meaning": "For his wealth of scholarship, manifested in the utterances of seventy-four poems,",
            "text": "चतुस्सप्ततिकाव्योक्तिव्यञ्ज्यवैदुष्यसम्पदे",
            "samasa_vigraha": "चतुस्सप्तति-काव्यानाम् उक्तिभिः व्यक्ता या वैदुष्यसम्पत् तस्यै"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "अगस्त्याय",
            "meaning": "for Agastya,",
            "text": "अगस्त्याय"
          },
          {
            "parsed": "जगति अस्मिन् स्पृहयेत्",
            "meaning": "in this world would aspire",
            "text": "जगत्यस्मिन् स्पृहयेत्"
          },
          {
            "parsed": "कः",
            "meaning": "who",
            "text": "को"
          },
          {
            "parsed": "न",
            "meaning": "not",
            "text": "न"
          },
          {
            "parsed": "कोविदः",
            "meaning": "the scholar?",
            "text": "कोविदः"
          }
        ]
      }
    ]
  },
  {
    "id": "1.15",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "स्तुमः तम् अपरम् व्यासम्",
            "meaning": "We praise him, another Vyāsa,",
            "text": "स्तुमस्तमपरं व्यासम्"
          },
          {
            "parsed": "गङ्गाधर-महा-कविम्",
            "meaning": "the great poet gangadhara,",
            "text": "गङ्गाधरमहाकविम्"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "नाटक-छद्मना दृष्टाम्",
            "meaning": "seen through the guise of a drama,",
            "text": "नाटकछद्मना दृष्टां",
            "samasa_vigraha": "नाटकस्य छद्म तेन दृष्टाम्  "
          },
          {
            "parsed": "यः चक्रे भारतीम् कथाम्",
            "meaning": "who made the Bhārata tale",
            "text": "यश्चक्रे भारतीं कथाम्"
          }
        ]
      }
    ]
  },
  {
    "id": "1.16",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "चिरं",
            "meaning": "For long",
            "text": "चिरं"
          },
          {
            "parsed": "सः विजयी भूयात्",
            "meaning": "may he be victorious,",
            "text": "स विजयी भूयात्"
          },
          {
            "parsed": "विश्वनाथः कवीश्वरः",
            "meaning": "Viśvanātha, the lord of poets;",
            "text": "विश्वनाथः कवीश्वरः",
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "यस्य प्रसादात् सार्वज्ञ्यम्",
            "meaning": "by whose grace, with contempt,",
            "text": "यस्य प्रसादात् सार्वज्ञ्यं"
          },
          {
            "parsed": "समिन्धे",
            "meaning": "is kindled,",
            "text": "समिन्धे"
          },
          {
            "parsed": "मादृशेषु अपि",
            "meaning": "even in people like us",
            "text": "मादृशेष्वपि"
          }
        ]
      }
    ]
  },
  {
    "id": "1.17",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "क्वचित् अर्थः",
            "meaning": "Somewhere, meaning;",
            "text": "क्वचिदर्थः"
          },
          {
            "parsed": "क्वचित् शब्दः",
            "meaning": "somewhere, expression;",
            "text": "क्वचिच्छब्दः"
          },
          {
            "parsed": "क्वचित् भावः",
            "meaning": "somewhere, emotion;",
            "text": "क्वचिद् भावः"
          },
          {
            "parsed": "क्वचित् रसः",
            "meaning": "somewhere, aesthetic essence.",
            "text": "क्वचिद् रसः"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "यत्र एते सन्ति",
            "meaning": "If these are present,",
            "text": "यत्रैते सन्ति"
          },
          {
            "parsed": "सर्वे अपि",
            "meaning": "all of them,",
            "text": "सर्वेऽपि"
          },
          {
            "parsed": "सः निबन्धः",
            "meaning": "that composition",
            "text": "स निबन्धः"
          },
          {
            "parsed": "न लभ्यते",
            "meaning": "is not to be found",
            "text": "न लभ्यते"
          }
        ]
      }
    ]
  },
  {
    "id": "1.18",
    "type": "madhuravijayam1",
    "parsings": [
      {
        "type": "line",
        "words": [
          {
            "parsed": "प्रबन्धम्",
            "meaning": "A composition,",
            "text": "प्रबन्धम्"
          },
          {
            "parsed": "ईषत्-मात्रः अपि",
            "meaning": "even a slight",
            "text": "ईषन्मात्रोऽपि"
          },
          {
            "parsed": "दोषः",
            "meaning": "fault,",
            "text": "दोषो"
          },
          {
            "parsed": "नयति",
            "meaning": "leads",
            "text": "नयति"
          },
          {
            "parsed": "दूष्यताम्",
            "meaning": "to blemish,",
            "text": "दूष्यताम्"
          }
        ]
      },
      {
        "type": "line",
        "words": [
          {
            "parsed": "काल-अगुरु-द्रव-भरम्",
            "meaning": "a full measure of black aloe-wood paste",
            "text": "कालागरुद्रवभरं",
            "samasa_vigraha": "कालागुरोः द्रवस्य भरम्"
          },
          {
            "parsed": "शुक्ति-क्षार-कणः",
            "meaning": "a particle of lime",
            "text": "शुक्तिक्षारकणो",
            "samasa_vigraha": "शुक्त्याः क्षारस्य कणः"
          },
          {
            "parsed": "यथा",
            "meaning": "just as",
            "text": "यथा"
          }
        ]
      }
    ]
  }
];

// Build the main clickable text from lines, with numbering
function getMainText(sh) {
  const line1 = sh.parsings[0].words.map(w => w.text).join(" ") + "।";
  const line2 = sh.parsings[1].words.map(w => w.text).join(" ") + "।।" + sh.id + "।।";
  return line1 + "\n" + line2;
}

function createShlokaElement(sh) {
  const container = document.createElement("div");
  container.className = "shloka";

  // Clickable shloka text (acts as toggle)
  const text = document.createElement("div");
  text.className = "text";
  const mainText = getMainText(sh).replace("\n", "<br>");
  text.innerHTML = mainText;
  container.appendChild(text);

  // Parsing (phrases) container, initially hidden
  const phrasesDiv = document.createElement("div");
  phrasesDiv.className = "phrases hidden";

  // Outer list: one item per Sanskrit word
  const outerList = document.createElement("ul");
  outerList.style.marginLeft = "1.2rem";

  sh.parsings.forEach(parsing => {
    parsing.words.forEach(w => {
      const wordItem = document.createElement("li");
      wordItem.className = "phrase";

      // Top-level: Sanskrit text
      const sk = document.createElement("span");
      sk.className = "sanskrit";
      sk.textContent = w.text;
      wordItem.appendChild(sk);

      // Inner list for parsed / vigraha / meaning
      const innerList = document.createElement("ul");
      innerList.style.marginLeft = "1.2rem";

      // Parsed (only if different)
      if (w.parsed && w.parsed !== w.text) {
        const parsedLi = document.createElement("li");
        parsedLi.className = "parsed";
        parsedLi.textContent = w.parsed;
        innerList.appendChild(parsedLi);
      }

      // Samāsa-vigraha (if present)
      if (w.samasa_vigraha) {
        const samasaLi = document.createElement("li");
        samasaLi.className = "samasa";
        samasaLi.textContent = w.samasa_vigraha;
        innerList.appendChild(samasaLi);
      }

      // Meaning (always)
      const meaningLi = document.createElement("li");
      meaningLi.className = "meaning";
      meaningLi.textContent = w.meaning;
      innerList.appendChild(meaningLi);

      wordItem.appendChild(innerList);
      outerList.appendChild(wordItem);
    });
  });

  phrasesDiv.appendChild(outerList);
  container.appendChild(phrasesDiv);

  // Toggle show/hide on shloka click
  text.addEventListener("click", () => {
    phrasesDiv.classList.toggle("hidden");
  });

  return container;
}

// When DOM is ready, render ALL shlokas
document.addEventListener("DOMContentLoaded", () => {
  const app = document.getElementById("app");
  shloka.forEach(sh => {
    app.appendChild(createShlokaElement(sh));
  });
});
